<UserControl
    x:Class="FocusTreeManager.Views.UserControls.Event"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Controls="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:uc="clr-namespace:FocusTreeManager.Views.UserControls"
    mc:Ignorable="d">
    <UserControl.Resources>
        <ResourceDictionary>
            <Style x:Key="WrapText" TargetType="{x:Type TextBlock}">
                <Setter Property="TextWrapping" Value="Wrap" />
            </Style>
            <Style x:Key="ControlStyle" TargetType="Control">
                <Setter Property="HorizontalAlignment" Value="Left" />
                <Setter Property="VerticalAlignment" Value="Center" />
            </Style>
            <Style BasedOn="{StaticResource ControlStyle}" TargetType="Label">
                <Setter Property="Margin" Value="-4,0,5,0" />
                <Setter Property="HorizontalAlignment" Value="Right" />
            </Style>
            <Style BasedOn="{StaticResource ControlStyle}" TargetType="TextBox">
                <Setter Property="Width" Value="200" />
                <Setter Property="Height" Value="25" />
            </Style>
            <Style BasedOn="{StaticResource ControlStyle}" TargetType="Controls:NumericUpDown">
                <Setter Property="Width" Value="200" />
                <Setter Property="Height" Value="25" />
            </Style>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Resources/Icons.xaml" />
                <ResourceDictionary x:Name="LocalizationStrings" Source="/FocusTreeManager;component/Languages/En_en.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="60*" />
            <ColumnDefinition Width="40*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition x:Name="TitleAndId" Height="70" />
            <RowDefinition x:Name="Picture" Height="180" />
            <RowDefinition x:Name="DescriptionRow" Height="250" />
            <RowDefinition x:Name="ChoicesRow" Height="90" />
            <RowDefinition x:Name="NoteRow" Height="150" />
        </Grid.RowDefinitions>
        <Grid Grid.Row="0" Background="{DynamicResource AccentBaseColorBrush}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="170" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="60*" />
                <RowDefinition Height="40*" />
            </Grid.RowDefinitions>
            <StackPanel Margin="10,0,0,0" Orientation="Horizontal">
                <Label
                    HorizontalAlignment="Stretch"
                    VerticalAlignment="Center"
                    Content="{DynamicResource Event_Id}"
                    FontSize="16"
                    FontWeight="Bold"
                    ToolTip="{DynamicResource Event_Id_Tooltip}" />
                <TextBox Text="{Binding Id, UpdateSourceTrigger=PropertyChanged}" />
            </StackPanel>
            <TextBlock
                Grid.Row="1"
                Grid.Column="0"
                Margin="40,0,0,0"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Center"
                FontSize="15"
                Foreground="{DynamicResource IdealForegroundColorBrush}"
                Text="{Binding Title}"
                ToolTip="{DynamicResource Event_Title_Tooltip}" />
            <Controls:ToggleSwitch
                Grid.Row="0"
                Grid.RowSpan="2"
                Grid.Column="1"
                Width="170"
                Header="{DynamicResource Event_Type_Switch}"
                ToolTip="{DynamicResource Event_Type_Switch_Tooltip}" />
        </Grid>
        <Image
            Grid.Row="1"
            Grid.Column="0"
            Source="{Binding ImagePath}"
            ToolTip="{DynamicResource Event_Picture}" />
        <Button
            Grid.Row="1"
            Grid.Column="0"
            Width="150"
            Margin="0,0,0,5"
            VerticalAlignment="Bottom"
            Command="{Binding ChangeImageCommand}"
            Content="{DynamicResource Command_Change}"
            Style="{DynamicResource SquareButtonStyle}" />
        <Grid
            Grid.Row="2"
            Grid.Column="0"
            Margin="10">
            <DockPanel x:Name="DescriptionText">
                <Label
                    Padding="5"
                    HorizontalAlignment="Stretch"
                    Content="{DynamicResource Event_Description}"
                    DockPanel.Dock="Top"
                    ToolTip="{DynamicResource Event_Description_Tooltip}" />
                <ScrollViewer DockPanel.Dock="Bottom">
                    <TextBlock
                        Margin="35,0,0,0"
                        Padding="5"
                        HorizontalAlignment="Stretch"
                        Text="{Binding Description}"
                        TextWrapping="Wrap" />
                </ScrollViewer>
            </DockPanel>
        </Grid>
        <Grid
            Grid.Row="3"
            Grid.Column="0"
            Margin="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="50*" />
                <ColumnDefinition Width="50*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition x:Name="FirstAndSecondBools" Height="35" />
                <RowDefinition x:Name="ThirdAndFourthBools" Height="35" />
            </Grid.RowDefinitions>
            <CheckBox
                Grid.Row="0"
                Grid.Column="0"
                Content="{DynamicResource Event_Major}"
                IsChecked="{Binding IsMajor}"
                ToolTip="{DynamicResource Event_Major_Tooltip}" />
            <CheckBox
                Grid.Row="0"
                Grid.Column="1"
                Content="{DynamicResource Event_Triggered}"
                IsChecked="{Binding IsTriggeredOnly}"
                ToolTip="{DynamicResource Event_Triggered_Tooltip}" />
            <CheckBox
                Grid.Row="1"
                Grid.Column="0"
                Content="{DynamicResource Event_Hidden}"
                IsChecked="{Binding IsHidden}"
                ToolTip="{DynamicResource Event_Hidden_Tooltip}" />
            <CheckBox
                Grid.Row="1"
                Grid.Column="1"
                Content="{DynamicResource Event_Fired_Once}"
                IsChecked="{Binding IsFiredOnce}"
                ToolTip="{DynamicResource Event_Fired_Once_Tooltip}" />
        </Grid>
        <Grid Grid.Row="4" Grid.Column="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="50*" />
                <ColumnDefinition Width="50*" />
            </Grid.ColumnDefinitions>
            <Label
                Grid.Column="0"
                Content="{DynamicResource Focus_Note}"
                ToolTip="{DynamicResource Focus_Note_Tooltip}" />
            <TextBox
                x:Name="NoteTextBox"
                Grid.Column="1"
                Height="120"
                Controls:TextBoxHelper.Watermark="{DynamicResource Focus_Note}"
                AcceptsReturn="True"
                HorizontalScrollBarVisibility="Disabled"
                Text="{Binding Note}"
                TextWrapping="Wrap"
                VerticalScrollBarVisibility="Auto" />
        </Grid>
        <DockPanel
            Grid.Row="0"
            Grid.Column="1"
            HorizontalAlignment="Stretch"
            Background="{DynamicResource AccentBaseColorBrush}">
            <Label
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Content="{DynamicResource Event_Description_Options}"
                FontSize="16"
                FontWeight="Bold"
                ToolTip="{DynamicResource Event_Description_Options_Tooltip}" />
        </DockPanel>
        <Grid
            Grid.Row="1"
            Grid.RowSpan="4"
            Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition x:Name="Descriptions" Height="*" />
                <RowDefinition x:Name="OptionsLabel" Height="72" />
                <RowDefinition x:Name="Options" Height="*" />
                <RowDefinition x:Name="ChangeScript" Height="35" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="50*" />
                <ColumnDefinition Width="50*" />
            </Grid.ColumnDefinitions>
            <DockPanel
                x:Name="DescriptionList"
                Grid.ColumnSpan="2"
                Background="{Binding Path=Background, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Window, AncestorLevel=1}}">
                <DataGrid
                    x:Name="GridDescriptions"
                    AlternatingRowBackground="{DynamicResource AccentColorBrush4}"
                    AlternationCount="2"
                    AutoGenerateColumns="False"
                    CanUserAddRows="True"
                    CanUserDeleteRows="True"
                    DockPanel.Dock="Bottom"
                    HorizontalScrollBarVisibility="Disabled"
                    ItemsSource="{Binding Path=Descriptions}"
                    VerticalScrollBarVisibility="Visible">
                    <DataGrid.Columns>
                        <DataGridTextColumn
                            Width="*"
                            Binding="{Binding Text}"
                            CanUserResize="False"
                            ElementStyle="{StaticResource WrapText}"
                            IsReadOnly="True">
                            <DataGridTextColumn.HeaderTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{DynamicResource Event_Description_Text}" />
                                </DataTemplate>
                            </DataGridTextColumn.HeaderTemplate>
                        </DataGridTextColumn>
                        <DataGridTemplateColumn Width="150" CanUserResize="False">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Button
                                        Command="{Binding DataContext.EditDescScriptCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type DataGrid}}}"
                                        CommandParameter="{Binding}"
                                        Content="{DynamicResource Command_Change}"
                                        IsEnabled="False"
                                        Loaded="FrameworkElement_OnLoaded"
                                        Style="{DynamicResource SquareButtonStyle}" />
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.HeaderTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{DynamicResource Event_Description_Script}" />
                                </DataTemplate>
                            </DataGridTemplateColumn.HeaderTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </DockPanel>
            <DockPanel
                Grid.Row="1"
                Grid.Column="0"
                Grid.ColumnSpan="2"
                HorizontalAlignment="Stretch"
                Background="{DynamicResource AccentBaseColorBrush}">
                <Label
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Content="{DynamicResource Event_Option}"
                    FontSize="16"
                    FontWeight="Bold"
                    ToolTip="{DynamicResource Event_Option_Tooltip}" />
            </DockPanel>
            <DockPanel
                Grid.Row="2"
                Grid.Column="0"
                Grid.ColumnSpan="2">
                <DataGrid
                    x:Name="GridOptions"
                    AlternatingRowBackground="{DynamicResource AccentColorBrush4}"
                    AlternationCount="2"
                    AutoGenerateColumns="False"
                    CanUserAddRows="True"
                    CanUserDeleteRows="True"
                    DockPanel.Dock="Bottom"
                    HorizontalScrollBarVisibility="Disabled"
                    ItemsSource="{Binding Path=Options}">
                    <DataGrid.Columns>
                        <DataGridTextColumn
                            Width="*"
                            Binding="{Binding Name}"
                            ElementStyle="{StaticResource WrapText}">
                            <DataGridTextColumn.HeaderTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{DynamicResource Event_Option_Name}" />
                                </DataTemplate>
                            </DataGridTextColumn.HeaderTemplate>
                        </DataGridTextColumn>
                        <DataGridTextColumn
                            Width="*"
                            Binding="{Binding Text}"
                            ElementStyle="{StaticResource WrapText}"
                            IsReadOnly="True">
                            <DataGridTextColumn.HeaderTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{DynamicResource Event_Option_Text}" />
                                </DataTemplate>
                            </DataGridTextColumn.HeaderTemplate>
                        </DataGridTextColumn>
                        <DataGridTemplateColumn Width="150" CanUserResize="False">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Button
                                        Command="{Binding DataContext.EditOptionScriptCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type DataGrid}}}"
                                        CommandParameter="{Binding}"
                                        Content="{DynamicResource Command_Change}"
                                        IsEnabled="False"
                                        Loaded="FrameworkElement_OnLoaded"
                                        Style="{DynamicResource SquareButtonStyle}" />
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                            <DataGridTemplateColumn.HeaderTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{DynamicResource Event_Option_Script}" />
                                </DataTemplate>
                            </DataGridTemplateColumn.HeaderTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </DockPanel>
            <Label
                Grid.Row="3"
                Grid.Column="0"
                Content="{DynamicResource Event_Script}" />
            <Button
                Grid.Row="3"
                Grid.Column="1"
                Width="150"
                Height="25"
                Command="{Binding EditScriptCommand}"
                Content="{DynamicResource Command_Edit}"
                Style="{DynamicResource SquareButtonStyle}" />
        </Grid>
        <Canvas
            Grid.Row="0"
            Grid.RowSpan="5"
            Grid.Column="0"
            Grid.ColumnSpan="2">
            <Button
                x:Name="TitleButton"
                Canvas.Top="35"
                Width="36"
                Height="36"
                Click="TitleButton_OnClick"
                Command="{Binding EditLocaleCommand}"
                CommandParameter="Title"
                Style="{DynamicResource MetroCircleButtonStyle}">
                <Rectangle
                    Width="15"
                    Height="15"
                    Fill="{Binding RelativeSource={RelativeSource AncestorType=Button}, Path=Foreground}">
                    <Rectangle.OpacityMask>
                        <VisualBrush Stretch="Fill" Visual="{StaticResource appbar_message}" />
                    </Rectangle.OpacityMask>
                </Rectangle>
            </Button>
            <Button
                x:Name="DescriptionButton"
                Canvas.Top="375"
                Width="36"
                Height="35"
                Click="DescriptionButton_OnClick"
                Command="{Binding EditLocaleCommand}"
                CommandParameter="Description"
                Style="{DynamicResource MetroCircleButtonStyle}">
                <Rectangle
                    Width="15"
                    Height="15"
                    Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType={x:Type Button}}}">
                    <Rectangle.OpacityMask>
                        <VisualBrush Stretch="Fill" Visual="{StaticResource appbar_message}" />
                    </Rectangle.OpacityMask>
                </Rectangle>
            </Button>
            <uc:Localizator x:Name="Localizator" Visibility="Hidden" />
        </Canvas>
    </Grid>
</UserControl>
